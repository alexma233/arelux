# AGENTS.md

> 这是一份给协作型 AI（下称“Agent”）的行为与输出规范，用于 **EdgeOne Monitoring Dashboard（EdgeOne 监控大屏）** 项目。在不与具体任务冲突的前提下，请严格遵循本文件。

---

## 1. 语言与风格（必须）

- **默认语言：简体中文**。除非任务明确要求英文或双语，否则一律使用简体中文回答。
- **技术名词保留**：API 名、方法名、指标名（如 `DescribeTimingL7AnalysisData`、`l7Flow_flux`）、文件路径、环境变量名保持原样；解释说明用中文。
- **文档语言一致性（必须）**：
  - `README.md`：以简体中文为主；允许少量英文术语/括号补充，但避免整段“中英对照式重复”。
  - 如确需完整英文文档：新增 `README.en-US.md`（仅英文），并在 `README.md` 中提供链接。

---

## 2. 代码片段要求（必须）

- Agent 在回答中给出的**所有代码块**必须包含**中文注释**（说明用途、关键参数、易错点）。
- 注释优先级：**意图 > 关键参数 > 易错点**。
- 对外文标识（API、指标、配置键、环境变量）**原样保留**，中文注释不要擅自改写其拼写。
- 涉及破坏性/不可逆操作（删除、覆盖、重置、迁移、批量替换）时：
  - 必须在代码块**上方**增加“注意”小节，明确风险、影响范围、回滚方式。
- 样例最小化：给出**可运行/可复现**的最小片段，避免无关依赖与长模板。

---

## 3. 信息架构与输出结构（建议）

推荐顺序：**结论先行 → 操作步骤 → 原因/原理 → 附录（可选）**。尽量包含：
1) 任务目标（一句话）  
2) 关键步骤（3–7 条）  
3) 常见坑（可选，2–3 条）  
4) 后续扩展（可选）

---

## 4. i18n（国际化）要求（必须）

本项目前端内置双语：`zh-Hans` 与 `en-US`。

### 4.1 文案来源与禁止项

- **禁止在模板/脚本中写死可见文案**（按钮、标题、提示语等），必须走 i18n。
- i18n 统一维护在 `assets/dashboard/i18n.js`（`MESSAGES` 内双语同 key）。

### 4.2 Key 设计与质量门槛

- 避免“拼接句”：尽量一整句一个 key，减少语序问题。
- 新增/修改文案时必须同时更新 `zh-Hans` 与 `en-US`，任何一端缺失视为不通过。
- 如引入占位符，优先使用**具名占位**并在注释说明单位/语境（如次数、字节、毫秒、时区）。

### 4.3 数字/时间本地化

- 前端展示数字/时间需尊重当前语言环境：优先使用 `getLocale()` 与 `toLocaleString(getLocale())` 等方式；不要把格式写死在字符串里。

---

## 5. 安全与边界（必须）

- **绝不输出或回显敏感凭据**：`SECRET_ID`、`SECRET_KEY`、私钥、Token、内部域名/IP 等必须使用占位符示例（如 `YOUR_SECRET_ID`）。
- 后端/函数日志中**不得打印密钥**或把请求对象/环境变量整包输出。
- 访问密钥权限遵循最小权限：文档与示例默认只读（如 `QcloudTEOReadOnlyaccess`）。
- 涉及费用/配额/计费接口时，必须明确提示可能成本，并给出“如何验证/如何停用”的路径。

---

## 6. 兼容性与清理策略（必须）

- **优先稳定性**：对外可见的接口与配置（URL 路由、查询参数、环境变量、i18n key）尽量保持向后兼容。
- 如必须产生破坏性变更：必须明确列出破坏点、受影响路径/配置，并提供可执行的迁移/回滚步骤。
- 允许清理无用代码/过期示例/废弃指标，但需确保不影响默认部署路径（EdgeOne Pages 与本地 `edgeone pages dev`）。

---

## 7. 文件职责与拆分（必须）

- **单文件单职责**：避免把互不相关逻辑混在同一文件。
- 约定（可作为默认拆分方向）：
  - 前端页面骨架：`index.html`
  - 前端逻辑：`assets/dashboard/*`（按功能/图表拆分）
  - 后端 API（Pages Functions）：`node-functions/api/[[default]].js`
  - 示例/回参：`辅助文件/*`（仅示例数据，不含敏感信息）
- 若发现历史文件已混杂多类职责：需提示用户应拆分，并给出“目标文件列表 + 迁移顺序 + 验证方式 + 回滚方式”。

---

## 8. 项目默认假设（适用于实现决策）

- **零构建/低依赖优先**：前端以静态资源 + CDN（Tailwind、ECharts）为主，避免引入不必要的打包/编译链。
- Node 端保持 **ESM**（`"type": "module"`），新增依赖需谨慎且说明理由。
- 部署主路径以 **EdgeOne Pages** 为优先，其次是本地开发验证。

---

## 9. 交付物清单（面向 Agent）

当被要求“实现/修改某功能”时，交付内容应包含：
1) 变更摘要（1 句话）  
2) 目录/文件影响（新增/修改/删除路径列表）  
3) 使用说明（如何配置/启用：环境变量、参数、页面入口）  
4) 验证步骤（如 `edgeone pages dev`，以及预期现象）  
5) 回滚提示（如何恢复）  
6) 建议的 `git commit message`（遵循仓库现有风格）

---

## 10. 常见错误清单（快速自查）

- 回答非简体中文（未被要求英文）  
- 代码块无中文注释或缺少破坏性操作风险提示  
- UI 文案写死在 `index.html` / JS 中，未更新 `assets/dashboard/i18n.js`  
- 输出/记录敏感凭据或可还原的密钥信息  
- 引入不必要的构建工具、重依赖或与现有结构冲突的拆分方式

---

**最后更新**：2025-12-20（UTC+8）
